Search.setIndex({"docnames": ["README", "distributions", "estimate_one", "estimate_two", "generative_process", "intro"], "filenames": ["README.md", "distributions.ipynb", "estimate_one.ipynb", "estimate_two.ipynb", "generative_process.ipynb", "intro.md"], "titles": ["About", "Likelihood of observed biomarker data", "Estimating <span class=\"math notranslate nohighlight\">\\(\\theta\\)</span> and <span class=\"math notranslate nohighlight\">\\(\\phi\\)</span>", "Estimating <span class=\"math notranslate nohighlight\">\\(k_j\\)</span>", "Generative process", "Event-Based Model (EBM)"], "terms": {"thi": [0, 1, 2, 3, 4, 5], "project": 0, "event": [0, 1, 4], "base": [0, 1, 2, 3, 4], "model": [0, 1, 2, 4], "which": [0, 1, 2, 3, 4, 5], "diseas": [0, 1, 2, 3, 5], "progress": [0, 1, 4, 5], "The": [0, 1, 2, 3, 4, 5], "book": [0, 5], "format": 0, "built": 0, "upon": 0, "jupyt": 0, "assum": [1, 2, 3, 4], "accord": [1, 2, 4], "set": [1, 3], "e_1": 1, "ldot": 1, "e_n": 1, "where": [1, 2, 3, 4, 5], "n": [1, 2, 3, 4], "number": [1, 3, 4], "our": [1, 2], "goal": 1, "estim": [1, 5], "an": [1, 2, 3, 4], "order": [1, 2, 3, 4, 5], "s": [1, 2, 3], "sigma": [1, 2, 3], "over": 1, "permut": [1, 4], "size": [1, 2, 3, 4], "valu": [1, 2, 3, 5], "marker": 1, "patient": [1, 5], "j": [1, 3, 4], "x_": [1, 3, 4], "nj": [1, 4], "mathbb": 1, "r": 1, "real": 1, "each": [1, 2, 3, 4], "person": 1, "ha": [1, 2, 3, 4, 5], "correspond": 1, "bernoulli": 1, "random": [1, 4], "variabl": 1, "d_j": 1, "0": [1, 2, 3, 4], "1": [1, 2, 3, 4, 5], "denot": [1, 4], "whether": [1, 4, 5], "thei": [1, 3, 5], "have": [1, 2, 3, 5], "note": [1, 3, 4], "gener": [1, 2, 5], "i": [1, 2, 3, 4, 5], "am": [1, 2], "includ": 1, "complet": 1, "For": [1, 3], "simplifi": 1, "notat": [1, 3], "k_n": [1, 2, 4], "current": [1, 3, 4], "stage": [1, 2, 3, 5], "let": [1, 3, 4], "theta_n": [1, 3, 4], "paramet": [1, 2, 3], "distribut": [1, 2, 3], "when": [1, 2, 3, 5], "phi_n": [1, 3, 4], "healthi": [1, 2, 4], "first": [1, 2, 3], "deal": 1, "equat": [1, 2, 3], "p": [1, 3, 4], "z_j": [1, 3, 4], "prod_": [1, 3], "mid": [1, 3, 4], "compuat": [1, 5], "given": [1, 3], "we": [1, 2, 3, 4, 5], "know": [1, 2, 3, 5], "ord": 1, "arrai": [1, 3, 4], "ar": [1, 3, 4, 5], "affect": [1, 2, 3, 4, 5], "exampl": [1, 2], "b": [1, 4], "d": [1, 2, 3], "c": 1, "mean": [1, 2, 3, 4], "At": 1, "2": [1, 2, 3, 4, 5], "indic": [1, 3, 4], "one": [1, 2, 5], "effect": 1, "been": [1, 4], "yet": 1, "probabl": [1, 2, 3, 4], "densiti": [1, 4], "function": [1, 4], "pdf": [1, 2, 4], "gaussian": [1, 2, 4], "45": 1, "50": 1, "55": 1, "60": 1, "standard": 1, "deviat": 1, "5": [1, 2, 3, 4], "NOT": [1, 4], "25": 1, "30": 1, "35": 1, "40": 1, "3": [1, 2, 3, 4], "x_j": 1, "repres": [1, 4], "all": [1, 2, 3, 5], "77": 1, "53": 1, "90": 1, "henc": 1, "next": [1, 3], "go": [1, 4, 5], "calcul": [1, 3], "s_": 1, "x_b": 1, "so": 1, "frac": [1, 2], "sqrt": [1, 2, 3], "pi": [1, 3], "e": [1, 3, 4, 5], "left": [1, 2, 4], "mu": [1, 2, 3], "right": [1, 2, 4], "becaus": [1, 2, 3], "should": [1, 3, 4], "us": [1, 2, 3, 5], "theta_b": 1, "therefor": [1, 2, 3], "plug": 1, "abov": [1, 2, 4], "can": [1, 4, 5], "do": [1, 2, 3, 5], "same": [1, 2, 5], "4": [1, 2, 3, 4], "time": [1, 4], "x_a": 1, "theta_a": 1, "x_d": 1, "phi_d": 1, "x_c": 1, "phi_c": 1, "specif": [1, 2, 3, 4, 5], "point": [1, 2], "itself": 1, "multipli": 1, "multipl": [1, 5], "give": [1, 3], "sum_": 1, "suppos": [1, 3], "inform": [1, 3, 5], "except": 1, "And": 1, "wonder": 1, "what": [1, 3], "see": [1, 3], "ovserv": 1, "five": 1, "equal": [1, 4], "like": [1, 3, 4], "best": 1, "option": 1, "averag": 1, "section": 1, "follow": [1, 2, 3, 4], "l_1": 1, "l_2": 1, "l_3": 1, "l_4": 1, "also": [1, 2, 3], "need": 1, "consid": 1, "l_0": 1, "start": [1, 3, 4], "from": [1, 2, 3, 4, 5], "phi_b": 1, "phi_a": 1, "If": 2, "were": 2, "write": 2, "sampler": 2, "knew": 2, "correct": 2, "particip": [2, 3], "wa": 2, "infer": [2, 3, 5], "both": [2, 3, 4], "didn": 2, "t": [2, 3], "discuss": 2, "varianc": 2, "would": 2, "ones": 2, "case": [2, 3], "updat": [2, 3], "exact": 2, "k_j": [2, 4], "data": [2, 3, 5], "biomark": [2, 3, 5], "its": 2, "drawn": [2, 4], "normal": [2, 3], "either": [2, 3], "conjugaci": 2, "occur": 2, "posterior": [2, 3], "famili": 2, "new": 2, "why": 2, "import": [2, 3, 4], "without": 2, "integr": 2, "oftentim": 2, "hard": 2, "three": 2, "major": 2, "beta": 2, "binomi": 2, "gamma": [2, 3], "poisson": 2, "In": 2, "measur": [2, 3, 4], "howev": [2, 3], "job": 2, "two": [2, 3], "introduct": 2, "bayesian": 2, "think": 2, "clyde": 2, "et": 2, "al": 2, "2022": 2, "come": [2, 5], "unknown": 2, "m_0": 2, "n_0": 2, "shape": 2, "v_0": 2, "rate": 2, "s_0": 2, "how": [2, 5], "strongli": 2, "belief": 2, "held": 2, "degress": 2, "freedom": 2, "influenc": 2, "certainti": 2, "That": [2, 4], "sai": 2, "sim": [2, 4], "mathcal": 2, "combin": 2, "normalgamma": 2, "m_n": 2, "n_n": 2, "s_n": [2, 3, 4], "v_n": 2, "more": 2, "beceaus": 2, "expect": 2, "alpha": [2, 3], "mode": 2, "median": 2, "sampl": 2, "degre": 2, "rule": 2, "get": [2, 3, 4, 5], "hyper": 2, "bar": 2, "y": [2, 3, 4], "n_0m_0": 2, "2v_0": 2, "n_0n": 2, "panda": [2, 3, 4], "pd": [2, 3, 4], "numpi": [2, 3, 4], "np": [2, 3, 4], "matplotlib": [2, 3], "pyplot": [2, 3], "plt": [2, 3], "scipi": [2, 4], "stat": [2, 4], "norm": [2, 4], "altair": [2, 3, 4], "alt": [2, 3, 4], "def": [2, 3, 4], "estimate_params_exact": [2, 3], "m0": [2, 3], "n0": [2, 3], "s0_sq": [2, 3], "v0": [2, 3], "vector": [2, 3], "summari": [2, 3], "sample_mean": [2, 3], "sample_s": [2, 3], "len": [2, 3], "sample_var": [2, 3], "var": [2, 3], "ddof": [2, 3], "unbias": [2, 3], "hyperparamet": [2, 3], "invers": [2, 3], "updated_m0": [2, 3], "updated_n0": [2, 3], "updated_v0": [2, 3], "updated_s0_sq": [2, 3], "updated_alpha": [2, 3], "updated_beta": [2, 3], "mu_posterior_mean": [2, 3], "sigma_squared_posterior_mean": [2, 3], "return": [2, 3, 4], "pymc": 2, "pm": 2, "log": 2, "logger": 2, "getlogg": 2, "setlevel": 2, "warn": [2, 3], "print": [2, 3], "f": [2, 3, 4], "run": 2, "v": 2, "__version__": 2, "estimate_param": 2, "relat": 2, "believ": 2, "precis": 2, "lambda": [2, 3], "sigma_squared_invers": 2, "lambda_": 2, "tau": 2, "likelihood": [2, 3, 5], "under": 2, "hypothesi": 2, "here": [2, 3], "truth": 2, "y_ob": 2, "math": 2, "observ": [2, 3, 4], "draw": [2, 4], "trace": 2, "1000": [2, 3], "progressbar": 2, "fals": [2, 3, 4], "mu_estim": [2, 3], "lambda_estim": 2, "var_estim": [2, 3], "convert": 2, "v5": 2, "6": [2, 3, 4], "valid": 2, "read_csv": [2, 3], "means_var": [2, 3, 4], "csv": [2, 3, 4], "observed_data": 2, "participant_data": [2, 3, 4], "head": [2, 3, 4], "affected_or_not": [2, 3, 4], "843800": 2, "12": [2, 3, 4], "107230": 2, "not_affect": [2, 3, 4], "11": [2, 3, 4], "664483": 2, "344041": 2, "10": [2, 3, 4], "940308": 2, "empti": [2, 3], "list": [2, 3], "dictionari": [2, 3], "store": [2, 3], "means_vars_estimate_dict_list": [2, 3], "_": 2, "rang": [2, 3, 4], "dic": [2, 3], "initi": [2, 3, 4], "outsid": [2, 3], "inner": [2, 3], "loop": [2, 3], "data_ful": [2, 3], "theta_mean": [2, 3, 4], "theta_var": [2, 3, 4], "els": [2, 3, 4], "phi_mean": [2, 3, 4], "phi_var": [2, 3, 4], "done": [2, 3], "append": [2, 3], "400": 2, "612616": 2, "401": 2, "7": [2, 3, 4], "433522": 2, "403": 2, "8": [2, 3, 4], "533455": 2, "404": 2, "238326": 2, "405": 2, "569257": 2, "495": 2, "553066": 2, "496": 2, "9": [2, 3, 4], "983062": 2, "497": 2, "555410": 2, "498": 2, "249201": 2, "499": 2, "365286": 2, "name": 2, "length": 2, "74": 2, "dtype": [2, 4], "float64": 2, "402": 2, "16": [2, 3, 4], "908686": 2, "406": 2, "17": [2, 4], "654661": 2, "407": 2, "18": [2, 3, 4], "428939": 2, "412": 2, "15": [2, 4], "135656": 2, "414": 2, "277092": 2, "417": 2, "383127": 2, "419": 2, "150064": 2, "422": 2, "317941": 2, "426": 2, "19": [2, 4], "186903": 2, "427": 2, "225541": 2, "430": 2, "651088": 2, "432": 2, "742225": 2, "436": 2, "577855": 2, "437": 2, "389521": 2, "438": 2, "783875": 2, "448": 2, "083512": 2, "449": 2, "892946": 2, "452": 2, "648727": 2, "456": 2, "500422": 2, "458": 2, "694367": 2, "459": 2, "912342": 2, "460": 2, "102702": 2, "475": 2, "140725": 2, "476": 2, "284308": 2, "488": 2, "366566": 2, "490": 2, "089180": 2, "estimate_df": 2, "datafram": [2, 3, 4], "to_csv": [2, 4], "estimate_means_var": 2, "index": [2, 3, 4], "993031": 2, "139293": 2, "544871": 2, "901018": 2, "927262": 2, "342140": 2, "259672": 2, "437009": 2, "694006": 2, "378585": 2, "13": [2, 4], "968279": 2, "459480": 2, "825942": 2, "148650": 2, "14": [2, 3, 4], "492427": 2, "26": 2, "890797": 2, "545282": 2, "938014": 2, "019592": 2, "372749": 2, "083058": 2, "381072": 2, "579832": 2, "907516": 2, "190562": 2, "623910": 2, "547153": 2, "320336": 2, "840615": 2, "811723": 2, "093594": 2, "295481": 2, "031355": 2, "355425": 2, "238634": 2, "997621": 2, "008815": 2, "430306": 2, "929565": 2, "092245": 2, "obtain_theta_phi_param": 2, "biomarker_data_est": 2, "reset_index": [2, 3, 4], "biomarker_data": 2, "theta_mean_est": 2, "theta_var_est": 2, "theta_std_est": 2, "theta_std": 2, "phi_mean_est": 2, "phi_var_est": 2, "phi_std_est": 2, "phi_std": 2, "chart": [2, 4], "mean1": 2, "std1": 2, "mean2": 2, "std2": 2, "x": [2, 4], "axi": [2, 3, 4], "x_theta": 2, "linspac": 2, "min": 2, "max": 2, "creat": 2, "df1": 2, "actual": 2, "df2": 2, "df3": 2, "concat": 2, "plot": [2, 3], "chart_theta": 2, "mark_lin": 2, "encod": [2, 4], "color": [2, 3, 4], "legend": 2, "titl": [2, 3, 4], "properti": [2, 4], "x_phi": 2, "chart_phi": 2, "concaten": 2, "horizont": 2, "hconcat_chart": 2, "hconcat": 2, "resolve_scal": 2, "independ": 2, "vertic": 2, "final_chart": 2, "vconcat": 2, "displai": 2, "final": [2, 3], "work": 3, "less": 3, "you": 3, "could": 3, "state": 3, "deriv": 3, "step": 3, "rel": 3, "Then": 3, "discret": [3, 4], "basic": 3, "below": 3, "column": [3, 4], "iter": [3, 4], "through": [3, 4, 5], "possibl": 3, "sequenc": [3, 4], "formula": 3, "associ": 3, "maximum": 3, "re": 3, "sub": 3, "text": 3, "tolist": 3, "rememb": 3, "try": 3, "theta_phi": 3, "compute_likelihood": 3, "comput": 3, "defin": [3, 4], "input": 3, "contain": [3, 4, 5], "integ": 3, "between": [3, 4], "boolean": 3, "output": 3, "biomarker_param": 3, "exp": 3, "disabl": 3, "scientif": 3, "set_printopt": 3, "suppress": 3, "true": [3, 4], "arang": 3, "stop": 3, "uniqu": 3, "num_iter": 3, "num_stag": 3, "estimated_stage_d": 3, "actual_stage_d": 3, "randint": [3, 4], "p_data": 3, "drop": [3, 4], "stage_likelihood": 3, "zero": 3, "measuremen": 3, "k": [3, 4], "biomaker_data": 3, "str": 3, "biomarker_stag": 3, "total": 3, "http": 3, "ebm": [3, 4], "book2": 3, "vercel": 3, "app": 3, "html": 3, "has_dupl": 3, "max_likelihood_stag": 3, "seri": [3, 4], "idxmax": 3, "estimated_stag": 3, "actual_stag": 3, "differ": [3, 5], "scatter": 3, "figur": 3, "figsiz": 3, "100": [3, 4], "axhlin": 3, "red": 3, "linestyl": 3, "xlabel": 3, "ylabel": 3, "origin": 3, "grid": 3, "show": 3, "access": 3, "data_we_hav": 3, "fill_up_data_we_hav": 3, "participant_stag": 3, "fill": 3, "up": 3, "add": 3, "participant_stage_d": 3, "dict": 3, "zip": 3, "appli": [3, 4], "row": 3, "It": 3, "type": 3, "get_estimate_means_vars_df": 3, "To": 3, "estimate_means_vars_df": 3, "just": 3, "means_vars_df": 3, "special": 3, "edg": 3, "might": 3, "still": 3, "exist": 3, "later": 3, "cannot": [3, 5], "ensur": 3, "high": [3, 4], "otherwis": [3, 4], "low": [3, 4], "p_biomaker_data": 3, "user": [], "hongtaoh": [], "anaconda3": [], "env": [], "bay": [], "lib": [], "python3": [], "site": [], "packag": [], "core": [], "fromnumer": [], "py": [], "3715": [], "runtimewarn": [], "slice": [], "_method": [], "_var": [], "out": [], "257": [], "invalid": [], "encount": [], "double_scalar": [], "ret": [], "rcount": [], "3432": [], "_mean": [], "190": [], "223": [], "divid": [], "arrmean": [], "um": [], "true_divid": [], "div": [], "cast": [], "unsaf": [], "control": 3, "consequ": 3, "won": 3, "rm": 4, "uniformpermut": 4, "cdot": 4, "uniform": 4, "discreteuniform": 4, "fall": 4, "g": [4, 5], "leq": 4, "theta_": 4, "gt": 4, "phi_": 4, "matrix": 4, "dimens": 4, "scalar": 4, "whose": 4, "randomli": 4, "theta": 4, "phi": 4, "simulate_ebm": 4, "arg": 4, "int": 4, "tupl": 4, "ndarrai": 4, "implic": 4, "kj": 4, "cell": 4, "participantid": 4, "statu": 4, "stage1": 4, "stage2": 4, "inclus": 4, "entri": 4, "none": 4, "full": 4, "object": 4, "seed": 4, "42": 4, "rand": 4, "alwai": 4, "thu": 4, "assign": 4, "past": 4, "rv": 4, "df_means_var": 4, "transpos": 4, "rename_axi": 4, "6849364778152223": 4, "1176545535601847": 4, "208712902239357": 4, "306143958522108": 4, "49608071244541": 4, "5481033473842178": 4, "480357751109007": 4, "9746791773998162": 4, "771925418252082": 4, "233606644224505": 4, "With": 4, "structur": 4, "df": 4, "make": 4, "wide": 4, "long": 4, "df_long": 4, "melt": 4, "var_nam": 4, "value_nam": 4, "exapand": 4, "values_df": 4, "join": 4, "df_expand": 4, "transform_dens": 4, "as_": 4, "groupbi": 4, "mark_area": 4, "q": 4, "facet": 4, "width": 4, "140": 4, "height": 4, "200": 4, "across": [4, 5], "587598": [3, 4], "452728": [3, 4], "479005": [3, 4], "840992": [3, 4], "283137": [3, 4], "conjug": 4, "prior": 4, "group": 4, "conjugate_data": 4, "df_kj_6": 4, "six": 4, "select": 4, "onli": 4, "bio_2_data": 4, "biomarker2": 4, "240": 4, "compr": 4, "participant10_data": 4, "mark_bar": 4, "tooltip": 4, "interact": 4, "participant10": 4, "to_list": 4, "obtain": 5, "biolog": 5, "factor": 5, "These": 5, "call": 5, "visit": 5, "typic": 5, "neuropsych": 5, "mmse": 5, "exami": 5, "blood": 5, "pressur": 5, "longitudin": 5, "singl": 5, "cohort": 5, "sever": 5, "assumpt": 5, "irrevers": 5, "alreadi": 5, "about": 5, "anoth": 5, "chapter": 5, "explain": 5, "simul": 5, "process": 5, "keyboardinterrupt": [], "traceback": [], "most": [], "recent": [], "last": [], "line": [], "22": [], "20": [], "21": [], "23": [], "24": [], "27": [], "file": [], "981": [], "__getitem__": [], "self": [], "kei": [], "978": [], "_valu": [], "980": [], "elif": [], "key_is_scalar": [], "_get_valu": [], "983": [], "is_hash": [], "984": [], "get_valu": [], "rais": [], "invalidindexerror": [], "985": [], "986": [], "label": [], "don": [], "resolv": [], "frozenset": [], "1089": [], "takeabl": [], "1086": [], "1088": [], "similar": [], "back": [], "posit": [], "loc": [], "get_loc": [], "1090": [], "_get_values_for_loc": [], "387": [], "rangeindex": [], "method": [], "toler": [], "385": [], "doc": [], "int64index": [], "386": [], "388": [], "is_integ": [], "is_float": [], "389": [], "new_kei": [], "filterwarn": 3, "ignor": 3, "28": [], "29": [], "op": [], "common": [], "72": [], "_unpack_zerodim_and_def": [], "local": [], "new_method": [], "other": [], "68": [], "notimpl": [], "70": [], "item_from_zerodim": [], "arraylik": [], "opsmixin": [], "__eq__": [], "unpack_zerodim_and_def": [], "41": [], "_cmp_method": [], "oper": [], "eq": [], "6243": [], "6240": [], "rvalu": [], "extract_arrai": [], "extract_numpi": [], "extract_rang": [], "6242": [], "errstat": [], "res_valu": [], "comparison_op": [], "lvalu": [], "6245": [], "_construct_result": [], "res_nam": [], "array_op": [], "275": [], "268": [], "should_extension_dispatch": [], "269": [], "isinst": [], "timedelta": [], "baseoffset": [], "timestamp": [], "nat": [], "270": [], "is_object_dtyp": [], "271": [], "272": [], "273": [], "is_scalar": [], "isna": [], "todo": [], "na": [], "276": [], "doe": [], "comparison": [], "vs": [], "277": [], "ne": [], "278": [], "bool": [], "miss": [], "185": [], "obj": [], "108": [], "npt": [], "bool_": [], "ndframe": [], "109": [], "110": [], "detect": [], "111": [], "183": [], "184": [], "_isna": [], "208": [], "inf_as_na": [], "192": [], "193": [], "treat": [], "nan": [], "null": [], "infinit": [], "194": [], "205": [], "206": [], "207": [], "libmiss": [], "checknul": [], "209": [], "abcmultiindex": [], "210": [], "notimplementederror": [], "multiindex": []}, "objects": {}, "objtypes": {}, "objnames": {}, "titleterms": {"about": 0, "likelihood": 1, "observ": 1, "biomark": [1, 4], "data": [1, 4], "definit": [1, 4], "known": [1, 3], "k_j": [1, 3], "unknown": [1, 3], "estim": [2, 3], "theta": [2, 3], "phi": [2, 3], "conjug": 2, "prior": 2, "implement": 2, "random": 3, "initil": 3, "result": [3, 4], "after": 3, "gibb": 3, "sampl": 3, "gener": 4, "process": 4, "paramet": 4, "simul": 4, "visual": 4, "distribut": 4, "all": 4, "valu": 4, "when": 4, "particip": 4, "certain": 4, "diseas": 4, "stage": 4, "compar": 4, "A": 4, "s": 4, "event": 5, "base": 5, "model": 5, "ebm": 5}, "envversion": {"sphinx.domains.c": 2, "sphinx.domains.changeset": 1, "sphinx.domains.citation": 1, "sphinx.domains.cpp": 6, "sphinx.domains.index": 1, "sphinx.domains.javascript": 2, "sphinx.domains.math": 2, "sphinx.domains.python": 3, "sphinx.domains.rst": 2, "sphinx.domains.std": 2, "sphinx.ext.intersphinx": 1, "sphinx": 56}})